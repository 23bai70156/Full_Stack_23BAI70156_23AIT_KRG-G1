import{u as h,r as n,A as e,b as j,j as s,L as b,a as g}from"./index-D5Dl40EV.js";function w(){const a=h();n.useEffect(()=>{e.getCurrentUser()&&e.getCurrentUser().roles.includes("ROLE_USER")?a("/user/dashboard"):e.getCurrentUser()&&e.getCurrentUser().roles.includes("ROLE_ADMIN")&&a("/admin/transactions")},[]);const{register:l,handleSubmit:x,formState:i}=j(),[o,t]=n.useState(""),[d,u]=n.useState(!1),p=async c=>{u(!0),await e.login_req(c.email,c.password).then(()=>{t(""),setTimeout(()=>{e.getCurrentUser().roles.includes("ROLE_USER")?a("/user/dashboard"):e.getCurrentUser().roles.includes("ROLE_ADMIN")&&a("/admin/transactions")},5e3),localStorage.setItem("message",JSON.stringify({status:"SUCCESS",text:"Login successfull!"}))},r=>{const m=r.response&&r.response.data&&r.response.data.message||r.message||r.toString();console.log(m),t(m==="Bad credentials"?"Invalid email or password!":"Something went wrong: Try again later!")}),u(!1)};return s.jsx("div",{className:"container",children:s.jsxs("form",{className:"auth-form",onSubmit:x(p),children:[s.jsx(b,{}),s.jsx("h2",{children:"Login"}),o!==""&&s.jsx("p",{children:o}),s.jsxs("div",{className:"input-box",children:[s.jsx("label",{children:"Email"}),s.jsx("br",{}),s.jsx("input",{type:"text",...l("email",{required:"Email is required!",pattern:{value:/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/g,message:"Invalid email address!"}})}),i.errors.email&&s.jsx("small",{children:i.errors.email.message})]}),s.jsxs("div",{className:"input-box",children:[s.jsx("label",{children:"Password"}),s.jsx("br",{}),s.jsx("input",{type:"password",...l("password",{required:"Password is required!"})}),i.errors.password&&s.jsx("small",{children:i.errors.password.message})]}),s.jsxs("div",{className:"msg",children:[" ",s.jsx(g,{to:"/auth/forgetpassword/verifyEmail",className:"inline-link",children:"Forgot password?"})]}),s.jsx("br",{}),s.jsx("div",{className:"input-box",children:s.jsx("input",{type:"submit",value:d?"Logging in...":"Login",className:d?"button button-fill loading":"button button-fill"})}),s.jsx("br",{}),s.jsxs("div",{className:"msg",children:["New member? ",s.jsx(g,{to:"/auth/register",className:"inline-link",children:"Register Here"})]})]})})}export{w as default};
